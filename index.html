import React, { useState, useEffect } from "react";

const fonts = [
  "Arial",
  "Courier New",
  "Georgia",
  "Times New Roman",
  "Verdana",
  "Comic Sans MS",
  "Impact",
];

const usTimeZones = [
  { label: "Eastern Time (ET)", value: "America/New_York" },
  { label: "Central Time (CT)", value: "America/Chicago" },
  { label: "Mountain Time (MT)", value: "America/Denver" },
  { label: "Pacific Time (PT)", value: "America/Los_Angeles" },
  { label: "Alaska Time (AKT)", value: "America/Anchorage" },
  { label: "Hawaii-Aleutian Time (HAT)", value: "Pacific/Honolulu" },
];

// Get time zone abbreviation like EST, PDT, etc.
function getTimeZoneAbbr(date, timeZone) {
  return date
    .toLocaleTimeString("en-US", {
      timeZone,
      timeZoneName: "short",
    })
    .split(" ")
    .pop();
}

// Format time with 12h or 24h option, plus tz abbreviation
function formatTime(date, timeZone, is24Hour) {
  const options = {
    timeZone,
    hour12: !is24Hour,
    hour: "numeric",
    minute: "2-digit",
    second: "2-digit",
  };
  let timeString = date.toLocaleTimeString("en-US", options);
  const abbr = getTimeZoneAbbr(date, timeZone);
  return `${timeString} ${abbr}`;
}

export default function ClockApp() {
  const [time, setTime] = useState(new Date());
  const [bgColor, setBgColor] = useState("#222");
  const [font, setFont] = useState(fonts[0]);
  const [timeZone, setTimeZone] = useState("America/New_York"); // default ET
  const [is24Hour, setIs24Hour] = useState(false);
  const [showSettings, setShowSettings] = useState(false);

  useEffect(() => {
    const interval = setInterval(() => setTime(new Date()), 1000);
    return () => clearInterval(interval);
  }, []);

  return (
    <div
      style={{
        height: "100vh",
        backgroundColor: bgColor,
        color: "white",
        fontFamily: font,
        display: "flex",
        flexDirection: "column",
        alignItems: "center",
        justifyContent: "center",
        transition: "background-color 0.5s",
        padding: "20px",
      }}
    >
      <h1 style={{ fontSize: "5rem", margin: 0 }}>
        {formatTime(time, timeZone, is24Hour)}
      </h1>

      <button
        onClick={() => setShowSettings(!showSettings)}
        style={{
          marginTop: "30px",
          padding: "10px 20px",
          fontSize: "1.2rem",
          cursor: "pointer",
          borderRadius: "6px",
          border: "none",
        }}
      >
        {showSettings ? "Close Settings" : "Open Settings"}
      </button>

      {showSettings && (
        <div
          style={{
            marginTop: "30px",
            backgroundColor: "#333",
            padding: "20px",
            borderRadius: "10px",
            width: "320px",
            boxShadow: "0 0 15px rgba(0,0,0,0.5)",
          }}
        >
          <label style={{ display: "block", marginBottom: "10px" }}>
            Background Color:
            <input
              type="color"
              value={bgColor}
              onChange={(e) => setBgColor(e.target.value)}
              style={{ marginLeft: "10px", cursor: "pointer" }}
            />
          </label>

          <label style={{ display: "block", marginBottom: "10px" }}>
            Font:
            <select
              value={font}
              onChange={(e) => setFont(e.target.value)}
              style={{
                marginLeft: "10px",
                fontFamily: font,
                cursor: "pointer",
              }}
            >
              {fonts.map((f) => (
                <option key={f} value={f} style={{ fontFamily: f }}>
                  {f}
                </option>
              ))}
            </select>
          </label>

          <label style={{ display: "block", marginBottom: "10px" }}>
            Time Zone:
            <select
              value={timeZone}
              onChange={(e) => setTimeZone(e.target.value)}
              style={{ marginLeft: "10px", cursor: "pointer" }}
            >
              {usTimeZones.map((tz) => (
                <option key={tz.value} value={tz.value}>
                  {tz.label}
                </option>
              ))}
            </select>
          </label>

          <label
            style={{
              display: "block",
              marginTop: "10px",
              cursor: "pointer",
              userSelect: "none",
            }}
          >
            <input
              type="checkbox"
              checked={is24Hour}
              onChange={(e) => setIs24Hour(e.target.checked)}
              style={{ marginRight: "8px", cursor: "pointer" }}
            />
            Use 24-hour (army) time
          </label>
        </div>
      )}
    </div>
  );
}
